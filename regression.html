<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Python-cod</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <ul class="nav nav-tabs bg-success shadow rounded sticky-sm-top ">
        <li class="nav-item">
          <a class="nav-link text-white" aria-current="page" href="../python/index.html">Главная</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="../data/index.html">Подключение и обработка</a>
        </li>
        <li class="nav-item">
            <a class="nav-link text-white" href="../text/index.html">Работа с данными</a>
          </li> 
        <li class="nav-item">
          <a class="nav-link text-white" href="../table/index.html">Визуализация</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="../photo/index.html">Модель</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="../test/index.html">Колаб test</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="../housing/index.html">Колаб housing</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active link-dark fw-bolder" href="../regression/index.html">Колаб регрессия</a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="../visual/index.html">Колаб визуализация</a>
        </li>
        <button type="button" class="btn btn-succes text-white px-3" type="submit" onClick="location.href='https://www.youtube.com/watch?v=kb8mcYwbFj8&ab_channel=GloAcademy'">YouTube</button> 
      </ul>
      
<div class="container">
<pre>
<code>
from google.colab import files
uploaded = files.upload()
__________________________________________________________________________________________

import pandas as pd

dataframe = pd.read_csv('test_ses.csv')
dataframe= dataframe.sort_values(by= "session_id" )[:5000]
dataframe
__________________________________________________________________________________________

dataframe.info()
__________________________________________________________________________________________

import pandas as pd
import numpy as np
import random
import matplotlib.pyplot as plt 
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score
import statsmodels.api as sm
__________________________________________________________________________________________

dataframe = dataframe.fillna(0)
dataframe
__________________________________________________________________________________________

plt.figure(figsize=(30, 10))
plt.scatter(
    dataframe["site1"], 
    dataframe["site2"],
    c="pink"
)
plt.xlabel("Сайт 1")
plt.ylabel("Сайт 2")
plt.show()
__________________________________________________________________________________________

x = dataframe['site1'].values.reshape(-1,1)
y = dataframe['site2'].values.reshape(-1,1) 
reg = LinearRegression()
reg.fit(x, y)
print('The linear model is: Y = {:.5} + {:.5}X'.format(reg.intercept_[0], reg.coef_[0][0]))
__________________________________________________________________________________________

predictions = reg.predict(x)
plt.figure(figsize=(30, 10))
plt.scatter(
    dataframe['site1'],
    dataframe['site2'],
    c='orange'
)
plt.plot(
    dataframe['site1'],
    predictions,
    c='yellow',
    linewidth=2
)
plt.xlabel("Сайт_1")
plt.ylabel("Сайт_2")
plt.show()
__________________________________________________________________________________________

x = dataframe['site1']
y = dataframe['site2']
X2 = sm.add_constant(x)
est = sm.OLS(y, X2)
est2 = est.fit()
print(est2.summary())
</code>
</pre>
</div>
</body>
</html>